var newDeck ={

  "0": {
    "value": 2,
    "name": "2",
    "suit": "spade",
    "imgUrl": "assets/PNG-cards-1.3/2_of_spades.png",
  },
  "1": {
    "value": 3,
    "name": "3",
    "suit": "spade",
    "imgUrl": "assets/PNG-cards-1.3/3_of_spades.png",
  },
  "2": {
    "value": 4,
    "name": "4",
    "suit": "spade",
    "imgUrl": "assets/PNG-cards-1.3/4_of_spades.png",
  },
  "3": {
    "value": 5,
    "name": "5",
    "suit": "spade",
    "imgUrl": "assets/PNG-cards-1.3/5_of_spades.png",
  },
  "4": {
    "value": 6,
    "name": "6",
    "suit": "spade",
    "imgUrl": "assets/PNG-cards-1.3/6_of_spades.png",
  },
  "5": {
    "value": 7,
    "name": "7",
    "suit": "spade",
    "imgUrl": "assets/PNG-cards-1.3/7_of_spades.png",
  },
  "6": {
    "value": 8,
    "name": "8",
    "suit": "spade",
    "imgUrl": "assets/PNG-cards-1.3/8_of_spades.png",
  },
  "7": {
    "value": 9,
    "name": "9",
    "suit": "spade",
    "imgUrl": "assets/PNG-cards-1.3/9_of_spades.png",
  },
  "8": {
    "value": 10,
    "name": "10",
    "suit": "spade",
    "imgUrl": "assets/PNG-cards-1.3/10_of_spades.png",
  },
  "9": {
    "value": 10,
    "name": "jack",
    "suit": "spade",
    "imgUrl": "assets/PNG-cards-1.3/jack_of_spades.png",
  },
  "10": {
    "value": 10,
    "name": "queen",
    "suit": "spade",
    "imgUrl": "assets/PNG-cards-1.3/queen_of_spades.png",
  },
  "11": {
    "value": 10,
    "name": "king",
    "suit": "spade",
    "imgUrl": "assets/PNG-cards-1.3/king_of_spades.png",
  },
  "12": {
    "value": 11,
    "name": "ace",
    "suit": "spade",
    "imgUrl": "assets/PNG-cards-1.3/ace_of_spades.png",
  },
  "13": {
    "value": 2,
    "name": "2",
    "suit": "clubs",
    "imgUrl": "assets/PNG-cards-1.3/2_of_clubs.png",
  },
  "14": {
    "value": 3,
    "name": "3",
    "suit": "clubs",
    "imgUrl": "assets/PNG-cards-1.3/3_of_clubs.png",
  },
  "15": {
    "value": 4,
    "name": "4",
    "suit": "clubs",
    "imgUrl": "assets/PNG-cards-1.3/4_of_clubs.png",
  },
  "16": {
    "value": 5,
    "name": "5",
    "suit": "clubs",
    "imgUrl": "assets/PNG-cards-1.3/5_of_clubs.png",
  },
  "17": {
    "value": 6,
    "name": "6",
    "suit": "clubs",
    "imgUrl": "assets/PNG-cards-1.3/6_of_clubs.png",
  },
  "18": {
    "value": 7,
    "name": "7",
    "suit": "clubs",
    "imgUrl": "assets/PNG-cards-1.3/7_of_clubs.png",
  },
  "19": {
    "value": 8,
    "name": "8",
    "suit": "clubs",
    "imgUrl": "assets/PNG-cards-1.3/8_of_clubs.png",
  },
  "20": {
    "value": 9,
    "name": "9",
    "suit": "clubs",
    "imgUrl": "assets/PNG-cards-1.3/9_of_clubs.png",
  },
  "21": {
    "value": 10,
    "name": "10",
    "suit": "clubs",
    "imgUrl": "assets/PNG-cards-1.3/10_of_clubs.png",
  },
  "22": {
    "value": 10,
    "name": "jack",
    "suit": "clubs",
    "imgUrl": "assets/PNG-cards-1.3/jack_of_clubs.png",
  },
  "23": {
    "value": 10,
    "name": "queen",
    "suit": "clubs",
    "imgUrl": "assets/PNG-cards-1.3/queen_of_clubs.png",
  },
  "24": {
    "value": 10,
    "name": "king",
    "suit": "clubs",
    "imgUrl": "assets/PNG-cards-1.3/king_of_clubs.png",
  },
  "25": {
    "value": 11,
    "name": "ace",
    "suit": "clubs",
    "imgUrl": "assets/PNG-cards-1.3/ace_of_clubs.png",
  },
  "26": {
    "value": 2,
    "name": "2",
    "suit": "diamonds",
    "imgUrl": "assets/PNG-cards-1.3/2_of_diamonds.png",
  },
  "27": {
    "value": 3,
    "name": "3",
    "suit": "diamonds",
    "imgUrl": "assets/PNG-cards-1.3/3_of_diamonds.png",
  },
  "28": {
    "value": 4,
    "name": "4",
    "suit": "diamonds",
    "imgUrl": "assets/PNG-cards-1.3/4_of_diamonds.png",
  },
  "29": {
    "value": 5,
    "name": "5",
    "suit": "diamonds",
    "imgUrl": "assets/PNG-cards-1.3/5_of_diamonds.png",
  },
  "30": {
    "value": 6,
    "name": "6",
    "suit": "diamonds",
    "imgUrl": "assets/PNG-cards-1.3/6_of_diamonds.png",
  },
  "31": {
    "value": 7,
    "name": "7",
    "suit": "diamonds",
    "imgUrl": "assets/PNG-cards-1.3/7_of_diamonds.png",
  },
  "32": {
    "value": 8,
    "name": "8",
    "suit": "diamonds",
    "imgUrl": "assets/PNG-cards-1.3/8_of_diamonds.png",
  },
  "33": {
    "value": 9,
    "name": "9",
    "suit": "diamonds",
    "imgUrl": "assets/PNG-cards-1.3/9_of_diamonds.png",
  },
  "34": {
    "value": 10,
    "name": "10",
    "suit": "diamonds",
    "imgUrl": "assets/PNG-cards-1.3/10_of_diamonds.png",
  },
  "35": {
    "value": 10,
    "name": "jack",
    "suit": "diamonds",
    "imgUrl": "assets/PNG-cards-1.3/jack_of_diamonds.png",
  },
  "36": {
    "value": 10,
    "name": "queen",
    "suit": "diamonds",
    "imgUrl": "assets/PNG-cards-1.3/queen_of_diamonds.png",
  },
  "37": {
    "value": 10,
    "name": "king",
    "suit": "diamonds",
    "imgUrl": "assets/PNG-cards-1.3/king_of_diamonds.png",
  },
  "38": {
    "value": 11,
    "name": "ace",
    "suit": "diamonds",
    "imgUrl": "assets/PNG-cards-1.3/ace_of_diamonds.png",
  },
  "39": {
    "value": 2,
    "name": "2",
    "suit": "hearts",
    "imgUrl": "assets/PNG-cards-1.3/2_of_hearts.png",
  },
  "40": {
    "value": 3,
    "name": "3",
    "suit": "hearts",
    "imgUrl": "assets/PNG-cards-1.3/3_of_hearts.png",
  },
  "41": {
    "value": 4,
    "name": "4",
    "suit": "hearts",
    "imgUrl": "assets/PNG-cards-1.3/4_of_hearts.png",
  },
  "42": {
    "value": 5,
    "name": "5",
    "suit": "hearts",
    "imgUrl": "assets/PNG-cards-1.3/5_of_hearts.png",
  },
  "43": {
    "value": 6,
    "name": "6",
    "suit": "hearts",
    "imgUrl": "assets/PNG-cards-1.3/6_of_hearts.png",
  },
  "44": {
    "value": 7,
    "name": "7",
    "suit": "hearts",
    "imgUrl": "assets/PNG-cards-1.3/7_of_hearts.png",
  },
  "45": {
    "value": 8,
    "name": "8",
    "suit": "hearts",
    "imgUrl": "assets/PNG-cards-1.3/8_of_hearts.png",
  },
  "46": {
    "value": 9,
    "name": "9",
    "suit": "hearts",
    "imgUrl": "assets/PNG-cards-1.3/9_of_hearts.png",
  },
  "47": {
    "value": 10,
    "name": "10",
    "suit": "hearts",
    "imgUrl": "assets/PNG-cards-1.3/10_of_hearts.png",
  },
  "48": {
    "value": 10,
    "name": "jack",
    "suit": "hearts",
    "imgUrl": "assets/PNG-cards-1.3/jack_of_hearts.png",
  },
  "49": {
    "value": 10,
    "name": "queen",
    "suit": "hearts",
    "imgUrl": "assets/PNG-cards-1.3/queen_of_hearts.png",
  },
  "50": {
    "value": 10,
    "name": "king",
    "suit": "hearts",
    "imgUrl": "assets/PNG-cards-1.3/king_of_hearts.png",
  },
  "51": {
    "value": 11,
    "name": "ace",
    "suit": "hearts",
    "imgUrl": "assets/PNG-cards-1.3/ace_of_hearts.png",
  },
}
  var dealerCardValue = [];
  var playerCardValue = [];
  var playerCardValueSecondHand = [];
  var dealerHand = [];
  var playerHand = [];
  var playerSecondHand = [];
  var cardsInPlay = [];
  var bank = 1000;
  var firstHandStand = false;
  var secondHandStand = true;


$(document).ready(function () {
  placeYourBet();
  $('.bet').keypress(function (element) {
  if (element.which != 8 && element.which != 0 && (element.which < 48 || element.which > 57)) {
    $('.errmsg').text("Numbers Only").show().fadeOut("slow");
    return false;
  }
  });
  $('.bet').bind("change paste keyup", placeYourBet);
});

getCard = function (element1, element2, element3) {
  var card = getNewCard();
  element1.push(newDeck[card].value);
  element2.push(card);
  $(element3).append($('<img>', {class:'card' + " " + 'card' + cardsInPlay.indexOf(card),src: newDeck[card].imgUrl}))
}

checkForAces = function(element) {
	if ($.inArray(12, element) > 0) {
		return true;
	} else if ($.inArray(25, element) > 0) {
		return true;
	} else if ($.inArray(38, element) > 0) {
		return true;
	} else if ($.inArray(51, element) > 0) {
		return true;
	} else return false;
}

checkForDuplicate = function(){
  card = Math.floor(Math.random() * 52);
  if (cardsInPlay.length === 0){
    return false;
  } else if (cardsInPlay.indexOf(card) === -1) {
       return false;
  } else 
    return true; 
}

getNewCard = function() {
  while (checkForDuplicate() === true) {
    checkForDuplicate();
  }
    cardsInPlay.push(card);
    return card
}

getValue = function(element1, element2, element3, element4, element5) {
	var total = 0;
	for (var i = 0; i < element1.length; i++) {
    total += element1[i] << 0;
	} if (total > 21 && checkForAces(element2) === true) {
		total = total - 10;
		$(element3).text(total);
    return total
	} else if (total > 21) {
		$(element3).text(total);
		gameOver(total, element4);
    $(element5).hide();
    return total
	} else $(element3).text(total);
	 return total
	}

placeYourBet = function() {
  if ($('.bet').val().length > 0) {
    $('.deal').prop('disabled', false);
  } else { $('.deal').prop('disabled', true);
      $('.hit').prop('disabled', true);
      $('.stand').prop('disabled', true);
      $('.doubleDown').prop('disabled', true);
    }
}

dealerLogic = function () {
	var $playerValue = getValue(playerCardValue, playerHand, '.playerValue', '.outcome', '.hit');
	var $dealerValue = getValue(dealerCardValue, dealerHand, '.dealerValue');
	if ($dealerValue < 17 && $dealerValue <= $playerValue) {
		getCard(dealerCardValue, dealerHand, '.dealerCards');
		dealerLogic();
	} else if ($dealerValue < $playerValue && $dealerValue < 21) {
		getCard(dealerCardValue, dealerHand, '.dealerCards');
		dealerLogic();
	};
}

showCards = function() {
	$('.hidden').show();
	$('.dealerCards').show();
	$('.upcard').hide();
	$('.downcard').hide();
}

isItSplit = function(element) {
	if (newDeck[element[0]].name === newDeck[element[1]].name) {
		$('.split').show();
	}return false
	}

gameOver = function(element1, element2) {
  var bet = parseInt($('.bet').val());
  var dealerValue = parseInt($('.dealerValue').text());
  var element = parseInt($(element1).text());
	if (element === 21 && dealerValue != 21) {
		$(element2).text('21! You win!');
		bank = parseInt(bank) + (2 * bet);
  } else if (element > 21) {
    console.log($(element2).text)
		$(element2).text('Bust! You lose!');
    bank = parseInt(bank) - (bet);
    console.log($(element2).text)
    console.log(element)
  } else if (element === dealerValue) {
		$(element2).text('Push!');
		bank = parseInt(bank) + bet;
  } else if (dealerValue > 21 && element < 21) {
		$(element2).text('Dealer bust! You win!');
		bank = parseInt(bank) + (2 * bet);
  } else if (element > dealerValue) {
		$(element2).text('You win!');
		bank = parseInt(bank) + (2 * bet);
  } else if (dealerValue > element) {
		$(element2).text('You lose!');
    bank = parseInt(bank) - (bet);
  } else gameState = true;
		$('.bank').text(bank);
}


doubleDown = function() {
  var bet = $('.bet').val();
  doubleDownBet = (bet * 2);
  bank = parseInt(bank) - bet;
  $('.bet').val(doubleDownBet);
}

setToZero = function() {
  $('.bank').text(bank);
  $('.outcome').text('');
  $('.secondOutcome').text('');
  $('.dealerValue').hide();
  $('.playerCards img').remove();
  $('.dealerCards img').remove();
  $('.dealerStarterCards img').remove();
  $('.dealerCards').hide();
  $('.playerCardsSecondHand img').remove();
  $('.split').hide();
  $('.secondHandButtons').hide();
  $('.upcard').show();
  $('.downcard').show();
  $('.hit').show();
  $('.stand').show();
  $('.doubleDown').show();
  $('.restart').show();
  $('.playerValueSecondHand').text('');
  $('.playerSecondHand').hide();
  dealerCardValue = [];
  playerCardValue = [];
  playerCardValueSecondHand = [];
  playerHand = [];
  playerSecondHand = [];
  dealerHand = [];
  cardsInPlay = [];
  firstHandStand = false;
  secondHandStand = true;
  $('.hit').prop("disabled", false);
  $('.stand').prop("disabled", false);
}

deal = function () {
	bank = parseInt($('.bank').text()) - parseInt($('.bet').val());
	setToZero();
	getCard(playerCardValue, playerHand, '.playerCards');
	getCard(playerCardValue, playerHand, '.playerCards');
	isItSplit(playerHand);
	getValue(playerCardValue, playerHand, '.playerValue', '.outcome', '.hit');
	getCard(dealerCardValue, dealerHand, '.dealerCards');;
	getCard(dealerCardValue, dealerHand, '.dealerCards');;
	$('.dealerStarterCards').prepend($('<img>', {class:'upcard',src: newDeck[dealerHand[1]].imgUrl}));
	$('.dealerStarterCards').prepend($('<img>', {class:'downcard',src: 'assets/images/mechanic-deck-marked-deck-of-animated-playing-cards-3.png'}));
	getValue(dealerCardValue, dealerHand, '.dealerValue');
  $('.stand').prop('disabled', false);
  $('.doubleDown').prop('disabled', false);
  $('.hit').prop('disabled', false);
}

$('.deal').on('click', function() {
	deal();
})

$('.hit').on('click', function() {
	getCard(playerCardValue, playerHand, '.playerCards');
	var playerHandValue = getValue(playerCardValue, playerHand, '.playerValue', '.outcome', '.hit');
  $('.doubleDown').hide();
  $('.split').hide();
  if (playerHandValue > 21 && secondHandStand === true) {
    gameOver('.playerValue', '.outcome');
    gameOver('.playerValueSecondHand', '.secondOutcome');
    $('.hit').hide();
    $('.doubleDown').hide();
    $('.stand').hide();
  } else if (playerHandValue > 21 && secondHandStand === false) {
    $('.hit').hide();
    $('.doubleDown').hide();
    $('.stand').hide();
    firstHandStand = true;
  };
})

$('.stand').on('click', function() {
  var playerHandValue = getValue(playerCardValue, playerHand, '.playerValue', '.outcome', '.hit');
  firstHandStand = true;
  if (secondHandStand === true) {
    dealerLogic();
    gameOver('.playerValue', '.outcome');
    gameOver('.playerValueSecondHand', '.secondOutcome');
    showCards();
  } 
  $('.hit').hide();
  $('.doubleDown').hide();
  $('.stand').hide();
  })

$('.doubleDown').on('click', function() {
  doubleDown();
  getCard(playerCardValue, playerHand, '.playerCards' );
  getValue(playerCardValue, playerHand, '.playerValue', '.outcome', '.hit');
  dealerLogic();
  if (secondHandStand === true) {
    showCards();
    gameOver('.playerValue', '.outcome');
    gameOver('.playerValueSecondHand', '.secondOutcome');
  } 
  doubleDownBet = parseInt($('.bet').val()) / 2;
  $('.bet').val(doubleDownBet);
  $('.split').hide();
  $('.hit').hide();
  $('.stand').hide();
  $('.doubleDown').hide();
  firstHandStand = true;
})

$('.restart').on('click', function() {
  location.reload();
})

$('.split').on('click', function() {
	oldCard = playerHand.splice(0,1);
	oldCardValue = playerCardValue.splice(0,1);
	playerSecondHand.splice(0,1,oldCard[0]);
	playerCardValueSecondHand.splice(0,1,oldCardValue[0]);
  bank = parseInt(bank) - parseInt($('.bet').val());
  $('.bank').text(bank);
	$('.card0').prependTo('.playerCardsSecondHand');
	getCard(playerCardValueSecondHand, playerSecondHand, '.playerCardsSecondHand');
	getCard(playerCardValue, playerHand, '.playerCards' )
	$('.playerSecondHand').show();
	$('.secondHandButtons').show();
	getValue(playerCardValueSecondHand, playerSecondHand, '.playerValueSecondHand', '.secondOutcome', '.secondHandHit');
	getValue(playerCardValue, playerHand, '.playerValue', '.outcome', '.hit');
	$('.split').hide();
  $('.secondOutcome').show();
  $('.secondHandHit').show();
  $('.secondHandStand').show();
  $('.secondHandDoubleDown').show();
  secondHandStand = false;
})

$('.secondHandHit').on('click', function() {
	getCard(playerCardValueSecondHand, playerSecondHand, '.playerCardsSecondHand');
	var playerSecondHandValue = getValue(playerCardValueSecondHand, playerSecondHand, '.playerValueSecondHand','.secondOutcome', '.secondHandHit');
  if (playerSecondHandValue > 21 && firstHandStand === true) {
  gameOver('.playerValueSecondHand', '.secondOutcome');
  gameOver('.playerValue', '.outcome');
  $('.secondHandHit').hide();
  $('.doubleDown').hide(); 
  $('.secondHandStand').hide();
  secondHandStand = true;
  } 
  else if (playerSecondHandValue > 21) {
  $('.secondHandHit').hide();
  $('.doubleDown').hide(); 
  $('.secondHandStand').hide();
  secondHandStand = true;
  } 
  $('.secondHandDoubleDown').hide();
})

$('.secondHandStand').on('click', function() {
  var playerSecondHandValue = getValue(playerCardValueSecondHand, playerSecondHand, '.playerValueSecondHand','.secondOutcome', '.secondHandHit');
  getValue(playerCardValueSecondHand, playerSecondHand, '.playerValueSecondHand','.secondOutcome', '.secondHandHit');
  secondHandStand = true;
  $('.secondHandHit').hide();
  $('.secondHandStand').hide();
  $('.secondHandDoubleDown').hide();
  if (firstHandStand === true) {
  dealerLogic();
  gameOver('.playerValue', '.outcome');
  gameOver('.playerValueSecondHand', '.secondOutcome');
  showCards();
  $('.hit').hide();
  $('.doubleDown').hide();
  $('.stand').hide();
  }
})

$('.secondHandDoubleDown').on('click', function() {
  doubleDown();
  getCard(playerCardValueSecondHand, playerSecondHand, '.playerCardsSecondHand');
  getValue(playerCardValueSecondHand, playerSecondHand, '.playerValueSecondHand','.secondOutcome', '.secondHandHit');
  dealerLogic();
  if (firstHandStand === true) {
    showCards();
    gameOver('.playerValue', '.outcome');
    gameOver('.playerValueSecondHand', '.secondOutcome');
  } 
  doubleDownBet = parseInt($('.bet').val()) / 2;
  $('.bet').val(doubleDownBet);
  secondHandStand = true;
  $('.secondHandHit').hide(); 
  $('.secondHandStand').hide();
  $('.secondHandDoubleDown').hide();
})













